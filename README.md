# Week Front News Report

> 自动化前端技术周刊聚合系统，参考：https://github.com/rookie-ricardo/erduo-skills

## 项目简介

Week Front News Report 是一个智能化的中文前端技术周刊聚合工具，基于 Cursor IDE 的 Agent Skill 架构，从高质量中文博客抓取内容，筛选生成每周 Markdown 报告。

## 核心特性

- **主从架构**: 主 Agent 调度 + SubAgent 并行执行
- **智能筛选**: 1-5 分质量评分，只收录 3 分以上内容
- **分层调度**: Tier1/Tier2/Tier3 优先级管理
- **智能缓存**: 7 天 TTL (168 小时)，避免重复抓取
- **早停机制**: 达到目标数量（20 条）即停止
- **浏览器支持**: 支持 JS 渲染页面抓取（MCP Chrome DevTools）
- **容错设计**: 单点失败不影响整体流程
- **结构化输出**: 标准 Markdown 格式周报
- **优雅降级**: 检测 Sub-agent 可用性，自动切换串行模式

## 目录结构

```
daily-news-report/
├── .claude/
│   └── agents/
│       └── worker.md          # Worker SubAgent 配置
├── skills/
│   └── daily-news-report/
│       ├── SKILL.md           # Skill 主文档（核心逻辑）
│       ├── sources.json       # 信息源配置
│       └── cache.json         # 缓存数据
├── NewsReport/                # 输出目录（运行时创建）
└── README.md
```

## 信息源配置

### Tier1 (高命中率)

| 源               | 类型     | 质量分 | 成功率 | 说明                           |
| ---------------- | -------- | ------ | ------ | ------------------------------ |
| 阮一峰的网络日志 | WebFetch | 4.5    | 95%    | 科技爱好者周刊，获取最新一期   |

### Tier2 (中等命中率)

| 源           | 类型     | 质量分 | 成功率 | 说明           |
| ------------ | -------- | ------ | ------ | -------------- |
| 张鑫旭的博客 | WebFetch | 4.8    | 98%    | 前端技术文章   |

### Tier3 (浏览器渲染)

| 源       | 类型    | 质量分 | 成功率 | 说明                      |
| -------- | ------- | ------ | ------ | ------------------------- |
| 掘金热榜 | Browser | 4.2    | 75%    | 需要 JS 渲染，403 on WebFetch |

## 使用方法

### 基本调用

```
/week-front-news-report
```

### 指定日期

```
/week-front-news-report 2026-01-21
```

## 输出格式

报告将生成在 `NewsReport/YYYY-WXX-news-report.md`（ISO 周格式，如 `2026-W04`）

```markdown
# Week Front News Report（YYYY-WXX）

> 本周筛选自 N 个信息源，共收录 20 条高质量内容
> 生成耗时: X 分钟 | 版本: v3.0

---

## 1. 标题

- **摘要**：2-4 行概述
- **要点**：
  1. 要点一
  2. 要点二
  3. 要点三
- **来源**：[链接](URL)
- **关键词**：`keyword1` `keyword2` `keyword3`
- **评分**：⭐⭐⭐⭐⭐ (5/5)

---
```

## 执行流程

1. **初始化**: 确定日期，读取 sources.json 和 cache.json，创建输出目录，检测 Sub-agent 可用性
2. **调度**: 并行调度 SubAgent（或串行执行降级模式）
3. **执行**: 按 Tier 优先级抓取和提取内容
4. **监控**: 收集结果，检查 SubAgent 返回状态，统计条目数量
5. **评估**: URL 去重、标题相似度去重、评分校准、排序
6. **生成**: 输出 Markdown 周报文件
7. **更新**: 更新 cache.json（运行记录、源统计、URL 缓存、内容指纹）

## 性能预期

| 场景       | 预期时间  | 说明                 |
| ---------- | --------- | -------------------- |
| 最优情况   | ~2 分钟   | Tier1 足够，无需浏览器 |
| 正常情况   | ~3-4 分钟 | 需要 Tier2 补充      |
| 需要浏览器 | ~5-6 分钟 | 包含 JS 渲染页面     |

## 配置文件

### sources.json

信息源配置，包含源 ID、URL、抓取方法（webfetch/browser）、质量评分等。

```json
{
  "version": "2.1",
  "sources": {
    "tier1": { ... },
    "tier2": { ... },
    "tier3_browser": { ... }
  },
  "fetch_config": { ... },
  "quality_thresholds": {
    "min_score_to_include": 3,
    "target_items": 20,
    "early_stop_threshold": 25
  }
}
```

### cache.json

缓存数据，包含历史统计、URL 缓存、内容指纹等。

- URL 缓存 TTL: 168 小时 (7 天)
- 内容指纹 TTL: 168 小时 (7 天)

## 技术架构

```
┌─────────────────────────────────────────────────────────────────────┐
│                        主 Agent (Orchestrator)                       │
│  职责：调度、监控、评估、决策、汇总                                    │
├─────────────────────────────────────────────────────────────────────┤
│                                                                      │
│   ┌──────────┐    ┌──────────┐    ┌──────────┐    ┌──────────┐     │
│   │ 1. 初始化 │ → │ 2. 调度   │ → │ 3. 监控   │ → │ 4. 评估   │     │
│   │ 读取配置  │    │ 分发任务  │    │ 收集结果  │    │ 筛选排序  │     │
│   └──────────┘    └──────────┘    └──────────┘    └──────────┘     │
│         │               │               │               │           │
│         ▼               ▼               ▼               ▼           │
│   ┌──────────┐    ┌──────────┐    ┌──────────┐    ┌──────────┐     │
│   │ 5. 决策   │ ← │ 够20条？  │    │ 6. 生成   │ → │ 7. 更新   │     │
│   │ 继续/停止 │    │ Y/N      │    │ 周报文件  │    │ 缓存统计  │     │
│   └──────────┘    └──────────┘    └──────────┘    └──────────┘     │
│                                                                      │
└──────────────────────────────────────────────────────────────────────┘
         ↓ 调度                              ↑ 返回结果
┌─────────────────────────────────────────────────────────────────────┐
│                        SubAgent 执行层                               │
├─────────────────────────────────────────────────────────────────────┤
│   ┌─────────────┐   ┌─────────────┐   ┌─────────────┐              │
│   │ Worker A    │   │ Worker B    │   │ Browser     │              │
│   │ (WebFetch)  │   │ (WebFetch)  │   │ (Headless)  │              │
│   │ Tier1 Batch │   │ Tier2 Batch │   │ JS渲染页面   │              │
│   └─────────────┘   └─────────────┘   └─────────────┘              │
└─────────────────────────────────────────────────────────────────────┘
```

## 筛选标准

**保留**:

- 前端新技术/框架
- CSS/JavaScript 深入技巧
- 开发工具/提效方案
- 实用教程/最佳实践
- 技术周刊精选

**排除**:

- 泛科普内容
- 营销软文
- 过度学术化
- 招聘信息

## 错误处理

| 错误类型       | 处理方式                         |
| -------------- | -------------------------------- |
| SubAgent 超时  | 记录错误，继续下一个             |
| 源 403/404     | 标记禁用，更新 sources.json      |
| 内容提取失败   | 返回原始内容，主 Agent 决定      |
| 浏览器崩溃     | 跳过该源，记录日志               |

## 依赖要求

- Cursor IDE（支持 Agent Skill 系统）
- MCP Chrome DevTools（可选，用于 Tier3 浏览器渲染源）
- 稳定的网络连接

## 兼容性

- 支持并行执行模式（Sub-agent worker 可用时）
- 自动降级到串行执行模式（Sub-agent 不可用时）
- 降级模式下会在周报开头显示警告信息